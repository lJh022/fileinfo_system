# 文件信息识别系统

这是一个用于从数据集中提取和整理信息的系统。该系统允许用户从数据集中选择感兴趣的字段，修改字段名称和值，并将这些信息导出为Excel表格格式。

## 功能特点

1. **数据加载**
   - 支持加载CSV和Excel格式的数据集
   - 自动识别并显示数据集中的所有可用字段

2. **字段管理**
   - 允许用户通过图形界面选择需要的字段
   - 支持调整字段顺序（上移/下移）
   - 支持修改字段显示名称

3. **值编辑**
   - 显示字段的所有唯一值
   - 支持手动修改字段值
   - 支持从文件导入替换规则
   - 支持导出初始值为替换规则模板

4. **数据预览**
   - 预览处理后的数据结果
   - 可调整预览行数和位置（开头、中间、结尾）

5. **行排序**
   - 根据每行有效元素数量进行排序（仅考虑选中的字段）
   - 支持升序（少→多）和降序（多→少）排列

6. **配置管理**
   - 保存当前的字段选择、顺序、名称和值替换规则
   - 加载已保存的配置
   - 管理（删除）已保存的配置

7. **数据导出**
   - 将选定的字段导出为新的Excel文件
   - 导出时应用所有字段名称和值的修改

## 系统要求

- Python 3.6 或更高版本
- 必要的Python包（见requirements.txt）

## 安装步骤

1. 克隆或下载本项目到本地
2. 安装所需的依赖包：
   ```
   pip install -r requirements.txt
   ```

## 使用说明

1. 运行程序：
   ```
   python file_info_system.py
   ```

2. **基本操作**：
   - 点击"选择数据集文件"按钮来加载您的数据集（支持.csv、.xlsx、.xls格式）
   - 在显示的字段列表中勾选您想要导出的字段
   - 使用上下箭头按钮调整字段顺序
   - 点击"重命名"按钮修改字段显示名称
   - 点击"编辑值"按钮修改字段中的值

3. **编辑字段值**：
   - 点击字段旁的"编辑值"按钮打开编辑对话框
   - 手动修改值或使用批量替换功能
   - 点击"导出初始值"按钮可导出替换规则模板
   - 点击"从文件导入替换规则"按钮可导入替换规则

4. **数据预览**：
   - 选择要预览的字段后，点击"预览数据"按钮
   - 在预览窗口中可调整显示行数和位置

5. **行排序**：
   - 选择要考虑的字段后，点击"行排序"按钮
   - 在排序设置对话框中选择排序顺序（升序或降序）
   - 点击确定应用排序
   - 注意：排序只考虑您选中的字段中的有效（非空）元素

6. **配置管理**：
   - 点击"配置"按钮，选择"保存当前配置"保存当前设置
   - 点击"配置"按钮，选择"加载配置"应用已保存的配置
   - 点击"配置"按钮，选择"管理配置"删除不需要的配置

7. **导出数据**：
   - 完成所有设置后，点击"导出选中字段到Excel"按钮
   - 选择保存位置并导出

## 替换规则文件格式

替换规则文件必须是Excel或CSV格式，包含以下两列：
- `原始值`：要被替换的原始值
- `新值`：替换后的新值

## 注意事项

- 确保您的数据集文件格式正确（CSV或Excel格式）
- 导出时至少需要选择一个字段
- 导出的Excel文件将自动添加.xlsx扩展名
- 配置信息保存在程序同目录下的`file_info_system_configs.json`文件中
- 行排序仅考虑您选中的字段中的有效元素数量 